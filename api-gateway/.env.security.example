# Security Configuration for TechNovaStore API Gateway

# HTTPS/SSL Configuration
HTTPS_ENABLED=true
HTTPS_PORT=3443
HTTPS_REDIRECT=true
SSL_CERT_DIR=./certs
SSL_KEY_FILE=private.key
SSL_CERT_FILE=certificate.crt
SSL_CA_FILE=ca_bundle.crt
SSL_PASSPHRASE=

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=100
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX=5
STRICT_RATE_LIMIT_WINDOW_MS=300000
STRICT_RATE_LIMIT_MAX=3
SEARCH_RATE_LIMIT_WINDOW_MS=60000
SEARCH_RATE_LIMIT_MAX=30
ORDER_RATE_LIMIT_WINDOW_MS=3600000
ORDER_RATE_LIMIT_MAX=10

# Speed Limiting Configuration
SPEED_LIMIT_WINDOW_MS=900000
SPEED_LIMIT_DELAY_AFTER=50
SPEED_LIMIT_DELAY_MS=500
SPEED_LIMIT_MAX_DELAY_MS=20000

# CSRF Protection
CSRF_ENABLED=true
CSRF_TOKEN_EXPIRY=86400000
CSRF_COOKIE_NAME=csrf-token
CSRF_HEADER_NAME=x-csrf-token
CSRF_SESSION_HEADER=x-session-id

# XSS Protection
XSS_PROTECTION_ENABLED=true
XSS_SANITIZE_INPUT=true
XSS_ALLOWED_TAGS=
XSS_ALLOWED_ATTRIBUTES=

# Content Security Policy
CSP_ENABLED=true
CSP_DEFAULT_SRC='self'
CSP_STYLE_SRC='self','unsafe-inline'
CSP_SCRIPT_SRC='self'
CSP_IMG_SRC='self',data:,https:
CSP_CONNECT_SRC='self'
CSP_FONT_SRC='self'
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC='self'
CSP_FRAME_SRC='none'
CSP_REPORT_URI=
CSP_REPORT_ONLY=false

# HSTS Configuration
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false

# Input Validation
MAX_REQUEST_SIZE=10mb
MAX_FIELD_SIZE=1048576
MAX_FIELDS=1000
MAX_FILES=10
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,doc,docx
MAX_FILE_SIZE=5242880

# Session Configuration
SESSION_SECRET=your-super-secret-session-key-change-this-in-production
SESSION_NAME=technovastore.sid
SESSION_MAX_AGE=86400000

# CORS Configuration
CORS_ORIGINS=https://technovastore.com,https://www.technovastore.com

# Security Headers
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block
REFERRER_POLICY=strict-origin-when-cross-origin
PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()

# Security Monitoring
LOG_SECURITY_EVENTS=true
ALERT_SUSPICIOUS_ACTIVITY=true
MAX_FAILED_ATTEMPTS=5
LOCKOUT_DURATION=900000

# JWT Security (should match shared config)
JWT_SECRET=your_super_secure_jwt_secret_key_minimum_32_characters
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
JWT_REFRESH_EXPIRES_IN=7d